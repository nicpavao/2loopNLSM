\documentclass[11pt,letter]{article}
\pdfoutput=1
\usepackage{jheppub}
\usepackage{amsmath,amssymb}
\usepackage[dvipsnames]{xcolor}
%\usepackage{hyperref}
\usepackage{xspace}
\usepackage{ifdraft}
\usepackage{epstopdf}
\usepackage{slashed}
\usepackage{anyfontsize}
\usepackage{tocloft}
\renewcommand{\cftdot}{.}
\renewcommand{\cftsubsecleader}{\cftdotfill{\cftdotsep}}
\usepackage{diagbox}
\usepackage{colortbl}
\usepackage{bbold}
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{stackengine}
\def\RA{\rlap{\scalebox{1.6}{$\leftrightarrow$}}}
\def\DA{\smash{\bclap{\scalebox{1.6}{$\downarrow$}}}}
\def\mystrut{\rule[-2ex]{0ex}{6ex}}

\usepackage{tikz-feynman} 
\usepackage{xcolor}
\hypersetup{
    colorlinks,
    linkcolor={nhpRed},
    citecolor={nhpBlue},
    urlcolor={nhpBlue}
}


\definecolor{nhpRed}{RGB}{161,0,0}
\definecolor{nhp4}{RGB}{203, 4, 31}
\definecolor{nhp3}{RGB}{244,99,30}
\definecolor{nhp2}{RGB}{255,159,0}
\definecolor{nhp1}{RGB}{48,152,152}
\definecolor{nhpBlue}{RGB}{0,100,144}
\definecolor{cutred}{RGB}{219,56,49}
\definecolor{hgreen}{RGB}{25,176,146}
\definecolor{hgreen1}{RGB}{175,230,175}
\definecolor{hblue}{RGB}{52,152,219}
\definecolor{hbluedark}{RGB}{36, 106, 160}
\definecolor{hblue1}{RGB}{255,255,166}
\definecolor{hred}{RGB}{216,83,117}
\definecolor{hreddark}{RGB}{151, 58, 81}
\definecolor{hred1}{RGB}{255,155,155}
\definecolor{cutred}{RGB}{219,56,49}
\definecolor{hgrey4}{RGB}{75,75,75}
\definecolor{hgrey5}{RGB}{50,50,50}
\definecolor{hgrey3}{RGB}{100,100,100}
\definecolor{hgrey}{RGB}{125,125,125}
\definecolor{hgrey2}{RGB}{125,125,125}
\definecolor{hgrey1}{RGB}{150,150,150}
\definecolor{hgrey0}{RGB}{175,175,175}
\definecolor{darkgreen}{RGB}{59,126,108}


%Comment commands
\newcommand{\ace}[1]{\textcolor{darkgreen}{\textbf{AE:}{#1}}}
\newcommand{\nhp}[1]{\textcolor{nhpRed}{\textbf{NHP:}{#1}}}


\usepackage[framemethod=default]{mdframed}
\newmdenv[skipabove=7pt,
skipbelow=7pt,
rightline=false,
leftline=false,
topline=false,
bottomline=false,
backgroundcolor=gray!15,
linecolor=gray,
innerleftmargin=5pt,
innerrightmargin=5pt,
innertopmargin=5pt,
innerbottommargin=5pt,
leftmargin=0cm,
rightmargin=0cm,
linewidth=4pt]{eBox}

\tikzset{Bfield/.style={decorate, double}}

\iffalse
\tikzfeynmanset{compat=1.1.0}
\immediate\write18{mkdir -p images}  %% Create `pgf-img` directory
\usetikzlibrary{external}  
          %% Load the `external` library
\immediate\write18{mkdir -p images}  %% Create `pgf-img` directory
\tikzexternalize[                     %% Activate externalization
  prefix=images/,                    %% Avoid cluttering the directory
 system call={                       %% Use lualatex in system call
    pdflatex \tikzexternalcheckshellescape -halt-on-error -shell-escape -interaction=batchmode -jobname="\image" "\texsource" || rm "\image.pdf"
  },
]
\fi
\tikzfeynmanset{
  fermion2/.style={
    /tikz/postaction={
      /tikz/decoration={
        markings,
        mark=at position 0.7 with {
          \arrow{>[length=6pt, width=7pt]};
        },
      },
      /tikz/decorate=true,
    },
  },
}


\definecolor{jaxoblue}{HTML}{0086FF}

\newcommand{\cP}{\rm{cov.}\pi}

\newcommand{\ie}{i.e.~}
\newcommand{\eg}{e.g.~}
\usepackage{xspace}
\newcommand{\Poincare}{Poincar\'e\xspace}

\newcommand{\cC}{g} % -- Crossing Count symbol.


\newcommand{\nkmc}[1][k]{N$^{#1}$MC\xspace}

\def\taua{{{\rm t}}}
\def\bartaua{{{\bar {\rm t}}}}

%%% Jacobi 1 %%%

\newcommand{\JacobiOneDoubleBox}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){4};
\vertex (a2) at (1.5,-1){2};
\vertex (a3) at (1.5,1){3};
\vertex (a4) at (-1.5,-1){1};
\vertex (mid1) at (0,-.5);
\vertex (mid2) at (0,.5);
\vertex (mid3) at (1,.5) ;
\vertex (mid4) at (1,-.5) ;
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5) ;
\diagram{
(a4) --[ultra thick,](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,](mid2),
(mid3) --[ultra thick,](mid2),
(mid1) --[ultra thick,](mid6),
(mid1) --[ultra thick,](mid4),
(mid5) --[ultra thick,nhp4](mid2),
(mid5) --[ultra thick,](mid6),
(mid3) --[ultra thick,](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\JacobiOneCrossedBox}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){4};
\vertex (a2) at (1.5,-1){2};
\vertex (a3) at (1.5,1){3};
\vertex (a4) at (-1.5,-1){1};
\vertex (mid1) at (0,-.5);
\vertex (mid2) at (0,.5);
\vertex (mid3) at (1,.5);
\vertex (mid4) at (1,-.5);
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5);
\vertex (mid7) at (-.5,0) {};
\diagram{
(a4) --[ultra thick,](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,](mid6),
(mid3) --[ultra thick,](mid2),
(mid1) --[ultra thick,](mid4),
(mid5) --[ultra thick,](mid7),
(mid7) --[ultra thick,](mid1),
(mid2) --[ultra thick,](mid6),
(mid5) --[ultra thick,nhp4](mid2),
(mid3) --[ultra thick,](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\JacobiOnePentaTriangle}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){4};
\vertex (a2) at (.5,-1){2};
\vertex (a3) at (.5,1){3};
\vertex (a4) at (-1.5,-1){1};
\vertex (mid1) at (-.5,-.5);
\vertex (mid2) at (-1,0);
\vertex (mid3) at (0,.5) ;
\vertex (mid4) at (0,-.5) ;
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5) ;
\diagram{
(a4) --[ultra thick,](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,](mid2),
(mid6) --[ultra thick,](mid2),
(mid1) --[ultra thick,](mid6),
(mid1) --[ultra thick,](mid4),
(mid5) --[ultra thick,](mid3),
(mid5) --[ultra thick,nhp4](mid2),
(mid3) --[ultra thick,](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}

%%% Jacobi 1 end %%%

%%% Jacobi 2 start %%%

\newcommand{\JacobiTwoCrossedBoxOne}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){2};
\vertex (a2) at (1.5,-1){4};
\vertex (a3) at (1.5,1){3};
\vertex (a4) at (-1.5,-1){1};
\vertex (mid1) at (0,-.5);
\vertex (mid2) at (0,.5);
\vertex (mid3) at (1,.5);
\vertex (mid4) at (1,-.5);
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5);
\vertex (mid7) at (-.5,0) {};
\diagram{
(a4) --[ultra thick,](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,](mid6),
(mid3) --[ultra thick,](mid2),
(mid1) --[ultra thick,nhp4](mid4),
(mid5) --[ultra thick,](mid7),
(mid7) --[ultra thick,](mid1),
(mid2) --[ultra thick,](mid6),
(mid5) --[ultra thick,](mid2),
(mid3) --[ultra thick,](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\JacobiTwoCrossedBoxTwo}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){3};
\vertex (a2) at (1.5,-1){4};
\vertex (a3) at (1.5,1){1};
\vertex (a4) at (-1.5,-1){2};
\vertex (mid1) at (0,-.5);
\vertex (mid2) at (0,.5);
\vertex (mid3) at (1,.5);
\vertex (mid4) at (1,-.5);
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5);
\vertex (mid7) at (-.5,0) {};
\diagram{
(a4) --[ultra thick,](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,](mid6),
(mid3) --[ultra thick,](mid2),
(mid1) --[ultra thick,nhp4](mid4),
(mid5) --[ultra thick,](mid7),
(mid7) --[ultra thick,](mid1),
(mid2) --[ultra thick,](mid6),
(mid5) --[ultra thick,](mid2),
(mid3) --[ultra thick,](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\JacobiTwoCrossedBoxThree}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){1};
\vertex (a2) at (1.5,-1){4};
\vertex (a3) at (1.5,1){2};
\vertex (a4) at (-1.5,-1){3};
\vertex (mid1) at (0,-.5);
\vertex (mid2) at (0,.5);
\vertex (mid3) at (1,.5);
\vertex (mid4) at (1,-.5);
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5);
\vertex (mid7) at (-.5,0) {};
\diagram{
(a4) --[ultra thick,](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,](mid6),
(mid3) --[ultra thick,](mid2),
(mid1) --[ultra thick,nhp4](mid4),
(mid5) --[ultra thick,](mid7),
(mid7) --[ultra thick,](mid1),
(mid2) --[ultra thick,](mid6),
(mid5) --[ultra thick,](mid2),
(mid3) --[ultra thick,](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}


%%% Jacobi 2 end %%%

%%% Graph sym start %%%

\newcommand{\CrossedBoxGraphSym}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){};
\vertex (a2) at (1.5,-1){};
\vertex (a3) at (1.5,1){};
\vertex (a4) at (-1.5,-1){};
\vertex (mid1) at (0,-.5);
\vertex (mid2) at (0,.5);
\vertex (mid3) at (1,.5);
\vertex (mid4) at (1,-.5);
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5);
\vertex (mid7) at (-.5,0) {};
\vertex (x1) at (-1.5,0);
\vertex (x2) at (1.5,0);
\diagram{
(a4) --[ultra thick,](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,](mid6),
(mid3) --[ultra thick,](mid2),
(mid1) --[ultra thick,](mid4),
(mid5) --[ultra thick,](mid7),
(mid7) --[ultra thick,](mid1),
(mid2) --[ultra thick,](mid6),
(mid5) --[ultra thick,](mid2),
(mid3) --[ultra thick,](mid4),
(x1) --[ultra thick,dashed,nhp4](x2),
};
\end{feynman}
\end{tikzpicture}
}
}

%%% Graph sym end %%%

%%% Unitarity cuts begin %%%

\newcommand{\PhysicalCutOne}[4]{ {
\begin{tikzpicture}[baseline=6]
\begin{feynman}
\vertex (a1) at (-1, 1) {#1};
\vertex (a2) at (1, 1) {#2};
\vertex [dot,scale=2](mid1) at (0.5,0.5){};
\vertex [dot,scale=1.5,hgrey0](mid2) at (0.5,0.5){};
\vertex [dot,scale=2](mid3) at (-0.5,0.5){};
\vertex [dot,scale=1.5,hgrey0](mid4) at (-0.5,0.5){};
\vertex [dot,scale=2](mid5) at (0,0){};
\vertex [dot,scale=1.5,hgrey0](mid6) at (0,0){};
\vertex (a3) at (-.5, -.5) {#3};
\vertex (a4) at (.5, -.5) {#4};
\diagram{
(mid3) --[ ultra thick](a1),
(mid1) --[ ultra thick](a2),
(mid1) --[ ultra thick,out=120,in=60,min distance=0.1cm](mid3),
(mid1) --[ ultra thick](mid3),

(mid1) --[ ultra thick](mid5),
(mid3) --[ ultra thick](mid5),

(mid5) --[ ultra thick](a4),
(mid5) --[ ultra thick,](a3)
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\PhysicalCutTwo}[4]{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-.6, -0.6) {#1};
\vertex (a2) at (-.6, 0.6) {#2};
\vertex [dot,scale=2](mid1) at (0,0){};
\vertex [dot,scale=1.5,hgrey0](mid2) at (0,0){};
\vertex [dot,scale=2](mid3) at (.8,0){};
\vertex [dot,scale=1.5,hgrey0](mid4) at (.8,0){};
\vertex [dot,scale=2](mid5) at (1.6,0){};
\vertex [dot,scale=1.5,hgrey0](mid6) at (1.6,0){};
\vertex (a3) at (2.2, .6) {#3};
\vertex (a4) at (2.2, -.6) {#4};
\diagram{
(mid1) --[ ultra thick,](a1),
(mid1) --[ ultra thick,](a2),
(mid1) --[ ultra thick,out=60,in=120,min distance=0.4cm](mid3),
(mid1) --[ ultra thick,out=-60,in=-120,min distance=0.4cm](mid3),
(mid3) --[ ultra thick,out=60,in=120,min distance=0.4cm](mid5),
(mid3) --[ ultra thick,out=-60,in=-120,min distance=0.4cm](mid5),
(mid5) --[ ultra thick](a4),
(mid5) --[ ultra thick,](a3)
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\MaxCut}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.2,0.8){};
\vertex (a2) at (1.2,-0.8){};
\vertex (a3) at (1.2,0.8){};
\vertex (a4) at (-1.2,-0.8){};
\vertex [dot,scale=2] (mid1) at (0,-.4){};
\vertex [dot,scale=1.5,hgrey0](mid1x) at (0,-.4){};
\vertex [dot,scale=2] (mid2) at (0,.4){};
\vertex [dot,scale=1.5,hgrey0] (mid2x) at (0,.4){};
\vertex [dot,scale=2] (mid3) at (0.8,.4){};
\vertex [dot,scale=1.5,hgrey0] (mid3x) at (0.8,.4){};
\vertex [dot,scale=2] (mid4) at (0.8,-.4){};
\vertex [dot,scale=1.5,hgrey0] (mid4x) at (0.8,-.4){};
\vertex [dot,scale=2] (mid5) at (-0.8,.4){};
\vertex [dot,scale=1.5,hgrey0] (mid5x) at (-0.8,.4){};
\vertex [dot,scale=2] (mid6) at (-0.8,-.4){};
\vertex [dot,scale=1.5,hgrey0] (mid6x) at (-0.8,-.4){};
\diagram{
(a4) --[ultra thick,](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,](mid2),
(mid3) --[ultra thick,](mid2),
(mid1) --[ultra thick,](mid6),
(mid1) --[ultra thick,](mid4),
(mid5) --[ultra thick,](mid2),
(mid5) --[ultra thick,](mid6),
(mid3) --[ultra thick,](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\SubtleCut}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-.8, -0.6) {};
\vertex (a2) at (-.8, 0.6) {};
\vertex (a3) at (-1, 0) {};
\vertex [dot, scale=2](mid1) at (0,0){};
\vertex [dot, scale=1.5,hgrey0](mid2) at (0,0){};
\vertex [dot, scale=2](mid3) at (1,0){};
\vertex [dot, scale=1.5,hgrey0](mid4) at (1,0){};
\vertex (a4) at (1.8, 0) {};
\diagram{
(mid1) --[ultra thick,](a1),
(mid1) --[ultra thick,](a2),
(mid1) --[ultra thick,](a3),
(mid1) --[ultra thick,](mid3),
(mid1) --[ultra thick,out=60,in=120,min distance=0.4cm](mid3),
(mid1) --[ultra thick,out=-60,in=-120,min distance=0.4cm](mid3),
(mid3) --[ultra thick](a4),
};
\end{feynman}
\end{tikzpicture}
}
}

%%% Unitarity cuts end %%%

\newcommand{\simplebox}{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1,1){2};
\vertex (a2) at (1,-1){4};
\vertex (a3) at (1,1){3};
\vertex (a4) at (-1,-1){1};
\vertex (mid3) at (.35,.35);
\vertex (mid4) at (.35,-.35);
\vertex (mid5) at (-.35,.35);
\vertex (mid6) at (-.35,-.35);
\diagram{(mid4) --[ultra thick,nhpRed](mid3),
(mid5) --[ultra thick,nhpRed](mid6),
(mid3) --[ultra thick,nhpRed](mid5),
(mid6) --[ultra thick,nhpRed](mid4),
(mid6) --[ultra thick,fermion2](a4),
(mid3) --[ultra thick,fermion2](a3),
(mid4) --[ultra thick,fermion2](a2),
(mid5) --[ultra thick,fermion2](a1),
};
\vertex [dot, scale=1.6](mid3a) at (.35,.35){};
\vertex [dot, scale=1.1,hgrey0](mid3b) at (.35,.35){};
\vertex [dot, scale=1.6](mid4a) at (-.35,.35){};
\vertex [dot, scale=1.1,hgrey0](mid4b) at (-.35,.35){};
\vertex [dot, scale=1.6](mid5a) at (.35,-.35){};
\vertex [dot, scale=1.1,hgrey0](mid5b) at (.35,-.35){};
\vertex [dot, scale=1.6](mid6a) at (-.35,-.35){};
\vertex [dot, scale=1.1,hgrey0](mid6b) at (-.35,-.35){};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\cubic}[7]{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex [dot, scale=2.6](mid1) at (0,0){};
\vertex [dot, scale=2.6](mid2) at (0,0){};
\vertex [dot, scale=2,#1](mid3) at (0,0){};
\vertex (a1) at (0,1){3};
\vertex (a2) at (.85,-.55){2};
\vertex (a3) at (-.85,-.55){1};
\diagram{
(mid1) --[ultra thick,#2,#3](a3),
(mid1) --[ultra thick,#4,#5](a2),
(a1) --[ultra thick,#6,#7](mid1),
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\AcubicB}[9]{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (0,0){};
\vertex (a2) at (-1.55,.85){2};
\vertex (a3) at (-1.55,-.85){1};
\vertex [dot, scale=2.6](mid1) at (-.85,0){};
\vertex [dot, scale=2.6](mid2) at (-.85,0){};
\vertex [dot, scale=2,#1](mid3) at (-.85,0){};
\vertex (a4) at (1.55,.85){3};
\vertex (a5) at (1.55,-.85){4};
\vertex [dot, scale=2.6](mid4) at (.85,0){};
\vertex [dot, scale=2.6](mid5) at (.85,0){};
\vertex [dot, scale=2,#1](mid6) at (.85,0){};
\diagram{
(mid1) --[ultra thick,#2,#3](a3),
(mid1) --[ultra thick,#4,#5](a2),
(mid4) --[ultra thick,#8,#9](a4),
(mid4) --[ultra thick,#8,#9](a5),
(mid1) --[ultra thick,#6,#7](a1),
(a1) --[ultra thick,#6,#7](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\Acubic}[7]{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (0,1){3};
\vertex (a2) at (.85,-.55){2};
\vertex (a3) at (-.85,-.55){1};
\vertex [dot, scale=2.6](mid1) at (0,0){};
\vertex [dot, scale=2.6](mid2) at (0,0){};
\vertex [dot, scale=2,#1](mid3) at (0,0){};
\diagram{
(a3) --[ultra thick,#2,#3](mid1),
(a2) --[ultra thick,#4,#5](mid1),
(mid1) --[ultra thick,#6,#7](a1),
};
\end{feynman}
\end{tikzpicture}
}
}


\newcommand{\dBox}[7]{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){2};
\vertex (a2) at (1.5,-1){4};
\vertex (a3) at (1.5,1){3};
\vertex (a4) at (-1.5,-1){1};
\vertex (mid1) at (0,-.5);
\vertex (mid2) at (0,.5);
\vertex (mid3) at (1,.5) ;
\vertex (mid4) at (1,-.5) ;
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5) ;
\diagram{
(a4) --[ultra thick](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,#1](mid2),
(mid3) --[ultra thick,#2](mid2),
(mid1) --[ultra thick,#3](mid6),
(mid1) --[ultra thick,#4](mid4),
(mid5) --[ultra thick,#5](mid2),
(mid5) --[ultra thick,#6](mid6),
(mid3) --[ultra thick,#7](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}


\newcommand{\dBoxR}[7]{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){2};
\vertex (a2) at (1.5,-1){4};
\vertex (a3) at (1.5,1){3};
\vertex (a4) at (-1.5,-1){1};
\vertex (mid1) at (0,-.5);
\vertex (mid2) at (0,.5);
\vertex (mid3) at (1,.5) ;
\vertex (mid4) at (1,-.5) ;
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5) ;
\diagram{
(a4) --[ultra thick,](mid6),
(a3) --[ultra thick,hred](mid3),
(a2) --[ultra thick,hred](mid4),
(a1) --[ultra thick,](mid5),
(mid1) --[ultra thick,#1](mid2),
(mid3) --[ultra thick,#2](mid2),
(mid1) --[ultra thick,#3](mid6),
(mid1) --[ultra thick,#4](mid4),
(mid5) --[ultra thick,#5](mid2),
(mid5) --[ultra thick,#6](mid6),
(mid3) --[ultra thick,#7](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}

\newcommand{\dBoxL}[7]{ {
\begin{tikzpicture}[baseline=(current  bounding  box.center)]
\begin{feynman}
\vertex (a1) at (-1.5,1){2};
\vertex (a2) at (1.5,-1){4};
\vertex (a3) at (1.5,1){3};
\vertex (a4) at (-1.5,-1){1};
\vertex (mid1) at (0,-.5);
\vertex (mid2) at (0,.5);
\vertex (mid3) at (1,.5) ;
\vertex (mid4) at (1,-.5) ;
\vertex (mid5) at (-1,.5);
\vertex (mid6) at (-1,-.5) ;
\diagram{
(a4) --[ultra thick,hred](mid6),
(a3) --[ultra thick,](mid3),
(a2) --[ultra thick,](mid4),
(a1) --[ultra thick,hred](mid5),
(mid1) --[ultra thick,#1](mid2),
(mid3) --[ultra thick,#2](mid2),
(mid1) --[ultra thick,#3](mid6),
(mid1) --[ultra thick,#4](mid4),
(mid5) --[ultra thick,#5](mid2),
(mid5) --[ultra thick,#6](mid6),
(mid3) --[ultra thick,#7](mid4),
};
\end{feynman}
\end{tikzpicture}
}
}




\DeclareMathOperator{\cut}{\mathcal{C}}

 \def\draftnote#1{{\color{red}\it #1}} 
\iffalse \def\draftnote#1{{\color{red}\it}} \fi

\def\sect#1{section~\ref{#1}}
\def\Fig#1{fig.~{\ref{#1}}}
\def\Fig#1{Fig.~{\ref{#1}}}
\def\Figs#1#2{figs.~{\ref{#1}} and {\ref{#2}}}
\def\Figs#1#2{Figs.~{\ref{#1}} and {\ref{#2}}}

\def\tab#1{table~{\ref{#1}}}
\def\Tab#1{Table~{\ref{#1}}}
\def\tabs#1#2{tables~{\ref{#1}} and {\ref{#2}}}
\def\Tabs#1#2{TablesnFigs.~{\ref{#1}} and {\ref{#2}}}

\def\spa#1.#2{\left\langle#1\,#2\right\rangle}
\def\spb#1.#2{\left[#1\,#2\right]}
\def\spash#1.#2{\spa{\smash{#1}}.{\smash{#2}}}
\def\spbsh#1.#2{\spb{\smash{#1}}.{\smash{#2}}}
\def\sand#1.#2.#3{%
\left\langle\smash{#1}{\vphantom1}^{-}\right|{#2}%
\left|\smash{#3}{\vphantom1}^{-}\right\rangle}
\def\sandpp#1.#2.#3{%
\left\langle\smash{#1}{\vphantom1}^{+}\right|{#2}%
\left|\smash{#3}{\vphantom1}^{+}\right\rangle}
\def\sandpm#1.#2.#3{%
\left\langle\smash{#1}{\vphantom1}^{+}\right|{#2}%
\left|\smash{#3}{\vphantom1}^{-}\right\rangle}
\def\sandmp#1.#2.#3{%
\left\langle\smash{#1}{\vphantom1}^{-}\right|{#2}%
\left|\smash{#3}{\vphantom1}^{+}\right\rangle}
\def\Shift#1#2{{[#1,#2\rangle}}
\def\twoloop{{2 \mbox{-} \rm loop}}

\def\tree{{\rm tree}}
\def\pol{\varepsilon}
\def\Tr{\, {\rm Tr}}
\def\tr{\, {\rm tr}}
\def\eps{\varepsilon}
\def\e{\varepsilon}
\def\ep{\varepsilon}
\def\SYM{MSYM}
\def\nn{\nonumber}
\def\sec#1{section~\ref{#1}}
\def\eqn#1{(\ref{#1})}
\def\Eqn#1{Equation~(\ref{#1})}
\def\eqns#1#2{eqs.~(\ref{#1}) and~(\ref{#2})}
\def\Eqns#1#2{Eqs.~(\ref{#1}) and~(\ref{#2})}
\def\Figref#1{Fig.~\ref{#1}}
\def\secref#1{section~\ref{#1}}
\def\Neqfour{{{\cal N}=4}}
\def\NeqFour{{{\cal N}=4}}
\def\Neqeight{{{\cal N}=8}}
\def\NeqEight{{{\cal N}=8}}
\def\NeqOne{{{\cal N}=1}}
\def\Fact{{\cal F}}
\def\f{\widetilde f}
\def\be{\begin{equation}}
\def\ee{\end{equation}}
\def\bea{\begin{eqnarray}}
\def\eea{\end{eqnarray}}
\def\ba{\begin{eqnarray}}
\def\ea{\end{eqnarray}}
\def\Ksl{{\s K}}
\def\ksl{\s{k}}
\def\Perm{{\cal P}}
\def\M{{\cal M}}
\def\ve{\varepsilon}
\def\tlambda{{\tilde\lambda}}
\def\MHVbar{$\overline{\hbox{MHV}}$}
\def\NMHVbar{$\overline{\hbox{NMHV}}$}
\def\P{{\rm P}}
\def\NHP{{\rm NHP}}
\def\mud{\lambda}
\def\bowtie{{\rm bow\mbox{-}tie}}
\newcommand{\cred}{\bf \color{red}}
 \newcommand{\cblue}{\color{blue}}
 \definecolor{MattOrange}{rgb}{1.0,0.4,0.2}
\newcommand{\cob}{ \bf \color{MattOrange}}
\newcommand{\andd}{\ , \quad \text{and}  \quad}
\newcommand{\forr}{\ , \quad \text{for}  \quad}

\newcommand\citepls{{\bf\color{red}[[Cite Needed]]}}

\newcommand{\afour}{\ensuremath{A_4^{\text{tree}}}}
\definecolor{NUpurple}{RGB}{078,042,132}

\newcommand{\draftnoteJM}[1]{\textbf{\color{blue}[#1]}}



\author{\large Alex Edison,}
\author{\large James Mangan,}
\author{\large and Nicolas H. Pavao}

\affiliation{Department of Physics and Astronomy, Northwestern
  University, Evanston, Illinois 60208, USA}

\emailAdd{alexander.edison@northwestern.edu, james.mangan@northwestern.edu, pavao@u.northwestern.edu}
  
\title{\center  \fontsize{18.8}{20} \selectfont  Towards Globally Color-Dual All-Loop Integrands}

\abstract{ For now, let's put the things we need to check/compute here in the abstract. 
\begin{enumerate}
\item Does our construction manifest all the cuts for the two-loop n-gon?
\item What is the physics story here? Perturbative corrections to special Galilon, DBI for inflation? 
\item How can bubble on external legs that are zero by IBP inform generalizations beyond pions?
\end{enumerate}
}

\makeatletter
\gdef\@fpheader{\,}

\begin{document}
\maketitle
\flushbottom
 
\setstackgap{S}{6pt}
\setstackgap{L}{7pt}

\section{Introduction}
\section{Review}
 To set the stage, it is worth distinguishing between the algebraic properties of functionally symmetric kinematics that satisfy color-kinematics globally, and some of the other constructions that appear in the literature. 

In this work, we will consider three different types of cubic representations, that we define below: 
\be
\stackrel{\Acubic{hgrey0}{}{nhpRed}{}{nhpRed}{fermion2}{}}{\text{Fundamental}}\qquad\qquad \stackrel{\cubic{hgrey0}{fermion2}{}{fermion2}{}{fermion2}{}}{\text{Bifundamental}}\qquad\qquad \stackrel{\Acubic{hgrey0}{}{nhpBlue}{}{nhpBlue}{}{nhpBlue}}{\text{Adjoint}}
\ee
In this review, we will present examples of this distinct kinematic representations that have appeared in the literature. Though from the get go, we stress that in this work we are interested in identifying the analog of adjoint representations of the kinematic numerators; those for which all legs are equally preferrenced by the functional dressing. The only non-trivial $S$-matrix in the literature that exhibits this property to all-loop order, is that of Zakharov-Mikhailov theory \cite{}. We will briefly review the perturbative construction of this theory below. 
\subsection{Color-dual Amplitudes}
Review of BCJ relations and Jacobi relations off-shell. Justify kinematic algebra in an off-shell framework by talking about on-shell construction. yada yada yada
\subsection{Color-dual Lagrangians} In the next section we will construct one-loop color-dual numerators using Lagrangian descriptions that are manifestly color-dual. As we will show, taking forward limits of tree-level numerators works as long as one can construct an off-shell description with a Lagrangian. Here we briefly review the off-shell examples of the kinematic algebra that will be relevant in this paper. 
\be
\mathcal{L}^{\text{semi-YM}} = - \frac{1}{2} G_{\mu\nu} F^{\mu\nu} = - \frac{1}{2} G_{\mu\nu} F^{\mu\nu} - \frac{g}{2} G_{\mu\nu} [A_\mu, A_\nu]
\ee
\paragraph{Self-Dual Yang-Mills} The first example in the literature \cite{} of color-dual Feynman rules is that of Yang-Mills theory in the self-dual sector (SDYM):
\be
\mathcal{L}^{\text{YM}} = -\frac{1}{4}F_{\mu\nu}F^{\mu\nu}
\ee
To obtain the Lagrangian for self-dual Yang-Mills, we applyy the self-dual condition that equates the field strength to its dual 2-form:
\be\label{SDcon}
F_{\mu\nu} = \frac{1}{2} \epsilon_{\mu\nu\rho\sigma}F^{\rho\sigma}
\ee
where $F_{\mu\nu} = \partial_\mu A_\nu -\partial_\nu A_\mu + g[A_\mu ,A_\nu]$ is the non-abelian $SU(N)$ field strength. Solutions to the self-dual condition automatically satisfy the Yang-Mills equation of motion due to the Bianchi identity:
\be
D^\mu F^{\mu\nu} = \frac{1}{2} \epsilon_{\mu\nu\rho\sigma}D^\mu F^{\rho\sigma} = 0
\ee
Solutions to \eqn{SDcon} correspond to instanton configurations that are probed by the gauge field path integral in the full non-perturbative description of Yang-Mills. In this paper, we will focus on the perturbative aspects of this constraint. Transforming from Cartesian coordinates to light cone coordinantes, $(t,x,y,z) \rightarrow (u,v,w,\bar{w})$, which take the following definition:
\be
u = t+x,\quad v=t-x, \quad w = y+iz
\ee
which gives the following expression for the invariant line element:
\be
ds^2 = 2(dudv - dwd\bar{w}) = dt^2 - d\vec{x}\cdot d\vec{x}
\ee
Applying this coordinate transformation to the self-dual condition of \eqn{SDcon}, we obtain the following three constraint equations from the original three cartesian coordinate expressions:
\begin{align} \label{SDLightCone1}
F_{uw} &=0\,,
\\
 \label{SDLightCone2}
 F_{uv} &= F_{w\bar{w}}\,,
\\
 \label{SDLightCone3}
 F_{v\bar{w}} &= 0\,,
\end{align}
Thus, in light-cone gauge, $A_u=0$, we obtain the follow set of equations that are one-to-one with the self-dual condition:
\be
A_u=0 \text{ and } \eqn{SDLightCone1} \quad\Rightarrow \quad A_w=0
\ee
The second equation \eqn{SDLightCone2}  then implies the following that $A_v$ and $A_{\bar{w}}$ depend on a single degree of freedom
\be
A_w=0\,,\,A_u=0 \text{ and }\eqn{SDLightCone2} \quad\Rightarrow \quad \partial_u A_v = \partial_w A_{\bar{w}}
\ee
This constraint is  satisfied with the following definition of the gauge field in terms of a single scalar degree of freedom which we call $\Psi$:
\be\label{SDDef}
A_v = \frac{1}{2} \partial_w \Psi, \qquad A_{\bar{w}} = \frac{1}{2} \partial_u \Psi,
\ee
Using this definition on the final self-dual constraint equation thus yields the following equation of motion for the dynamical scalar field:
\be\label{SDEOM}
\eqn{SDLightCone1} \text{ and } \eqn{SDDef} \quad  \Rightarrow\quad \Box \Psi + ig [\partial_u \Psi, \partial_w \Psi ]=0
\ee
Adding back in the anti-holomorphic field $\bar{\Psi}$ as a Lagrange multiplier, we obtain the following interaction Lagrangian for self-dual Yang-Mills theory:
\begin{eBox}
\be
\mathcal{L}^{\text{SDYM}} = (\partial \bar{\Psi})(\partial \Psi) -i g \bar{\Psi} [\partial_u \Psi, \partial_w \Psi ]
\ee
\end{eBox}
The color-ordered ordered cubic Feynman rule for this theory can be immediately read off as follows:
\be
\cubic{hgrey0}{fermion2}{}{fermion2}{}{fermion2}{} =X(k_1,k_2) \equiv k_{u,1}k_{w,2} - k_{w,1}k_{u,2}
\ee
In this form, the Lagrangian and Feynman rules are manifestly color-dual \textit{off-shell}. In this form, we can see the effect \eqn{SDcon} had on the Feynman rules of the full Yang-Mills Lagrangian: it simply decoupled the anti-MHV three-point vertex from the theory, leaving only the MHV three-point vertex. Before proceeding, it is important to note that the mass-dimension of the theory appears to differ from that of Yang-Mills -- we comment on this in detail in our appendix on spinor-helicity variables and conventions. 

As we will show in \sect{}, the color-dual nature of SDYM can be understood as a direct consequence of isolating the \textit{cubic-sector} of the full Yang-Mills amplitudes by projecting along particular on-shell states. For this reason, the color-dual nature depends critically on the loop order of the amplitude and does not hold generically beyond one-loop. 

Next we will briefly describe a 2D scalar theory, Zakharov-Mikhailov (ZM) theory, whose equations of motion bear a striking resemblance to the SDYM equatioi of motion given above in \eqn{SDEOM}.

\paragraph{YZ-Theory}
SDYM makes explicit reference to the spacetime dimension and Zakharov-Mikhailov theory, to be discussed in \sect{sec:ZMTheory}, does as well.
This makes both theories poorly suited for constructing dimensionally-regulated loop-level amplitudes.
On the other hand, YZ-theory is an honest $D$-dimensional theory that captures the classical physics of the nonlinear sigma model (NLSM) while manifest the duality between color and kinematics \cite{Cheung2016prv}.

One can understand YZ-theory as a particular dimensional reduction of Yang-Mills in $D=2d+1$ dimensions, down to $d$ dimensions. 
Starting with the Yang-Mills Lagrangian, one can redefine the gauge fields, $A_M$, in terms of $X$, $Y$ and $Z$ fields:
\begin{align}
X_M &= (X_\mu,0,-iX_\mu) 
\\
Y_M &= (0,Y,0) 
\\
Z_M &= (Z_\mu,0,iZ_\mu) 
\end{align}
where $X$ and $Z$ are $d$-vectors and $Y$ is a scalar field. Considering the conjugate nature of the X-Z propagator, in this work we will make the replacement $X\rightarrow \bar{Z}$. Plugging this redefinition of the gauge fields in, upto cubic order, we thus obtain the following Lagrangian:
\begin{eBox}
\be
\mathcal{L}^{\text{YZ}} =\frac{1}{2} (\partial Y)^2 + (\partial Z)(\partial \bar{Z}) - g f^{abc} \left( \bar{Z}_{\mu\nu}Z^{\mu} Z^\nu + [Y,\partial_\mu Y] Z^\mu \right)
\ee
\end{eBox}
The Feynman rules for this Lagrangian are simply:
\be
\Acubic{hgrey0}{}{nhpRed}{}{nhpRed}{fermion2}{} = i \varepsilon_3 (p_1-p_2)\qquad \cubic{hgrey0}{fermion2}{}{fermion2}{}{fermion2}{} =i(\varepsilon_1 p_{2})(\varepsilon_2\bar{\varepsilon}_3) - i(\varepsilon_2 p_{1})(\varepsilon_1\bar{\varepsilon}_3)
\ee
Now we review of the construction of NLSM numerators at tree-level. In this construction, we can define generators of the kinematic algebra can be expressed as follows
\be\label{eq:FeynmanRuleYYZ}
T^a_{ij}= i \varepsilon_a(p_i-p_j)
\ee
where momentum conservation requires
\be
p_a + p_i + p_j =0
\ee
The kinematic half-ladder diagrams then takes on the following concise definition:
\be
n^{\text{NLSM}}_{(i|a_1a_2...a_n|j)} = (T^{a_1}T^{a_2}\cdots T^{a_n})_{ij}
\ee
Since there are on pole cancelling factors of $s_{ij} = (p_i+p_j)^2$, this definition of the chiral current algebra is manifestly cubic. Thus, the kinematic structure constants defined in terms of these generators are invariant under generalized gauge freedom. They can be defined implicitly below:
\be
[T^a,T^b]_{ij}= F^{a}_{\,b|c}T^c_{ij}
\ee
Given this definition, the Feynman rule associated with kinematic structure constant is simply:
\be\label{eq:FeynmanRuleXZZ}
i F^{a}_{\,b|c} = (\varepsilon_b p_{ab})(\varepsilon_a\bar{\varepsilon}_c) - (\varepsilon_a p_{ab})(\varepsilon_b\bar{\varepsilon}_c) 
\ee
where $p_{ab}=p_a+p_b$ and $\epsilon$ and $\bar{\epsilon}$ are the polarizations of the $Z$-vectors particle and its conjugate field, respectively. The on-shell state sum for the polarization vectors is simply:
\be
\sum_{\text{states}} \varepsilon^{\,\mu}_{(p)}\bar{\varepsilon}^{\,\nu}_{(-p)} = \eta^{\mu\nu}
\ee
Notice that the vector state sum is gauge fixed since the $Y\,Z$ model explicitly chooses Lorenz gauge for the $Z$ particles, $\partial_\mu Z^\mu=0$. To recover NLSM amplitudes from this these kinematic structure constants at tree-level, we simply plug in the following on-shell polarizations for the $Z$ and $\bar{Z}$ particles:
\be\label{eq:onShellZStates}
\varepsilon^\mu_{(p)} = p^\mu \qquad \bar{\varepsilon}^\mu_{(p)} = \frac{q^\mu}{pq}
\ee
where $q^2=0$ is some null reference momentum. With this, we can define tree-level pion scattering in two equivalent ways:
\be
A^{\text{NLSM}} = A(...,Y,...,Y,...) = A(...,\bar{Z},...) 
\ee
where the ellipses denote additional on-shell $Z$-particles. Subject to a particular gauge choice, the kinematic numerators in latter definition for pion scattering is equivalent to those $J$-theory, first written down by Cheung and one of the authors \cite{Cheung:2021zvb}. In this paradigm, the on-shell $\bar{Z}$ state is equivalent to the root leg appearing in the color-dual $J$-theory numerators. 

It is instructive to see how both of these constructions produce valid tree-level amplitudes for the pion. First we'll start with two $Y$ particles on legs 1 and 4. Applying the Feynman rules above, and plugging in on-shell states for the $Z$-particles produces the following $s$- and $t$-channel numerators:
\begin{align}
n^{YY}_s &= (T^2T^3)_{14} = s_{12}^2 
\\
 n^{YY}_t &=  F^{3}_{\,2|X}T^X_{14}  = s_{14}(s_{13}-s_{12})
\end{align}
Plugging these numerators into the ordered amplitudes $A(s,t)$ yields the desired result:
\be\label{eq:NLSMYZ4point}
A^{YY}_{(s,t)} = \frac{n^{YY}_s}{s_{12}}+\frac{ n^{YY}_t }{s_{14}} = s_{13}
\ee
Similarly we can do the same for the $Z$ and $\bar{Z}$ configuration. Below we have plugged in the on-shell $Z$-particle states, but have left the $\bar{Z}$ index free. This produces the following numerators:
\begin{align}
n^{\bar{Z}Z}_s &= {}_4(F^{3}F^{2})_{1} =  s_{12}(s_{14}-s_{13})p_2^{\mu_1}+s_{12}^2(p_3-p_4)^{\mu_1}
\\
 n^{\bar{Z}Z}_t &=   {}_2(F^{3}F^{4})_{1}  = s_{14}(s_{12}-s_{13})p_4^{\mu_1}+s_{14}^2(p_3-p_2)^{\mu_1}
\end{align}
where we have defined the short hand notation:
\be
{}_x(F^{a_1}F^{a_2}\cdots F^{a_n})_{y} \equiv F^{a_1}_{\,x|b_2}F^{a_2}_{\,b_2|b_3}\cdots F^{a_n}_{\,b_n|y}
\ee
Similarly, we find the following ordered amplitude when plugging in these numerators:
\be
A^{\bar{Z}Z}_{(s,t)} = \frac{n^{\bar{Z}Z}_s}{s_{12}}+\frac{ n^{\bar{Z}Z}_t }{s_{14}} = -s_{13}(p_2+p_3+p_4)^{\mu_1} = s_{13} \,p_1^{\mu_1}
\ee
Plugging in the on-shell polarizatoin of the conjugate field in \eqn{eq:onShellZStates} produces precisely the desired result of \eqn{eq:NLSMYZ4point}. Indeed, this construction is valid to all orders at tree-level. One can see this by considering the only two possible factorization channels the contribute the each of these amplitudes, the $YY$ cut and the $\bar{Z}Z$ cut:
\begin{align}
A(...,Y,...,Y,...) &\rightarrow A(...,Y,...,Y)A(Y,...,Y,...)
\\
&\rightarrow A(...,Y,...,Y,...,Z)A(\bar{Z},...)
\end{align}
Both factorization channels are valid descriptions of NLSM amplitudes when plugging in the $Z$ and $\bar{Z}$ on-shell states. As constructed, the $Y$ and $\bar{Z}$ particles may be off-shell, while the $Z$ particles must be placed on shell, $\varepsilon^Z_\mu(k)\rightarrow k_\mu$ in order for these numerators to produce NLSM ordered amplitudes. Given this special property of YZ-theory (namely that the $Z\bar{Z}$ and $YY$ constrctions are equivalent), the $Y$ particle need not be considered when constructing NLSM amplitudes on shell. This is essentially what $J$-thepory does, as we will show below.
\paragraph{J-theory} There is an alternative color-dual formulation of NLSM that the theory manifestly corresponds to NLSM at least at tree level \cite{Cheung:2021zvb}.
For related formulations of NLSM that do not treat color-kinematics duality see \cite{Freedman:1980us, Slavnov:1971mz}.
The construction begins with a first order formulation of NLSM in terms of chiral currents $J^\mu$.
First order formulation of NLSM in terms of chiral current $J^\mu$.
Two equations.
Two constraints, the field strength should vanish
\be
\label{eq:FieldStrengthJ}
F_{\mu\nu}(J) = \partial_\mu J_\nu - \partial_\nu J_\mu + g[J_\mu , J_\nu]=0
\ee
which then implies that $J^\mu$ is pure gauge $J_\mu = U \partial_\mu U^{-1}$.
The second condition is that the chiral current should be in Lorenz gauge
\be
\label{eq:LorenzGaugeJ}
\partial_\mu J^\mu=0
\ee
which then yields the NLSM equation of motion $\partial_\mu (U \partial^\mu U^{-1})=0$.
Taking a linear combination of \eqref{eq:FieldStrengthJ} and \eqref{eq:LorenzGaugeJ} yields
\be
\label{eq:JTheoryEOM}
\Box J^\mu +g f^{abc} J^\nu \partial_\nu J^\mu = 0.
\ee
Integrating in an auxiliary field $\bar{J}^\mu$ as a Lagrange multiplier trivially produces the Lagrangian
\begin{eBox}
\be
\mathcal{L}^{\text{J}} =\bar{J}^\mu \Box J_\mu +g f^{abc} \bar{J}^\mu J^\nu \partial_\nu J^\mu .
\ee
\end{eBox}
By calculating an off-shell 4pt correlation function it is possible to check that this Lagrangian automatically satisfies color-kinematics duality.
Kinematic algebra is diff algebra (as usual).
How to extract physical states... (longitudinal J, weird J bar, restores broken Bose).

This theory is one-to-one with the observables amplitudes of YZ-theory when only considering $Z-\bar{Z}$ on-shell states. As such, the single vertex in this theory is the same as for YZ theory: 
\be
\cubic{hgrey0}{fermion2}{}{fermion2}{}{fermion2}{} =i(\varepsilon_1 p_{2})(\varepsilon_2\bar{\varepsilon}_3) - i(\varepsilon_2 p_{1})(\varepsilon_1\bar{\varepsilon}_3)
\ee

\draftnoteJM{Put comment about the fact that you can use funny propagators without affecting CK earlier.  Mention NANS as modification of J-theory.}

\paragraph{ZM-theory}
\label{sec:ZMTheory}
While J-theory manifests color-kinematics duality, it only does so at tree level because J-theory breaks manifest Bose symmetry.
Manifest color-kinematics duality can be achieved at all loop orders by restricting J-theory to two spacetime dimensions where the chiral current can be dualized to a scalar $J^\mu = \epsilon^{\mu\nu} \partial_\nu \varphi$, which trivially enforces Lorenz gauge.
After plugging $\varphi$ into \eqref{eq:JTheoryEOM} and rearranging, another copy of $\varphi$ (rather than some new field) can be integrated in to obtain the Zakharov-Mikhailov (ZM) Lagrangian
\begin{eBox}
\be
\mathcal{L}^{\text{ZM}} = \frac{1}{2}(\partial \varphi)^2 + g f^{abc} \varphi^a (\partial^\mu \varphi^b)( \tilde{\partial}_\mu \varphi^c) =  \text{tr}\left[\frac{1}{2}(\partial \varphi)^2-i g \varphi [\partial_t \varphi, \partial_z \varphi ]\right]
\ee
\end{eBox}
where $\tilde{\partial}_\mu = \epsilon_{\mu\nu}\partial^\nu $.
This procedure makes it clear that ZM and NLSM encode the same classical physics, that is, their equations of motion are dual to each other.
The color-stripped Feynman rule for the three-point vertex can be read off from the Lagrangian, giving
\be
\langle ab\rangle \equiv p_a^\mu \epsilon_{\mu\nu} p_b^\nu =p_a^0 p_b^1 - p_a^1 p_b^0 = -\langle ba \rangle .
\ee
The vertex is (1) functionally symmetric and (2) the kinematic portion of the vertex is completely anti-symmetric: 
\be
\cubic{hgrey0}{}{nhpBlue}{}{nhpBlue}{}{nhpBlue} = \langle 12\rangle = \langle 23\rangle = \langle 31\rangle = -\langle 21\rangle
\ee
This important property is due to momentum conservation alone and does not need any additional kinematic constraints to satisfy the duality.
To prove off-shell color kinematics duality for any multiplicity and loop order it is enough to observe that the sum of the off-shell $s$-, $t$-, and $u$-channel numerators sum to zero
\be
\label{eq:ZMJacobi}
\langle ab \rangle \langle cd\rangle +\langle ac \rangle \langle db\rangle +\langle ad \rangle \langle bc\rangle =0 % \delta^{[a}_c\delta^{b]}_d + \delta^{[a}_d\delta^{c]}_b+ \delta^{[a}_b\delta^{d]}_c
\ee
by virtue of the 2D Levi-Civita identity $\epsilon_{\mu\nu}\epsilon_{\rho\sigma} = \eta_{\mu\rho}\eta_{\nu\sigma}-\eta_{\mu\sigma}\eta_{\nu\rho}$.
Amusingly, \eqref{eq:ZMJacobi} is simply a manifestation of the Schouten identity.

Since ZM theory manifested color-kinematics duality without any reference to the on-shell condition, a mass term can be added to ZM theory without spoiling color-kinematics duality.
In fact, the kinetic term could be dramatically altered.
In general, if the on-shell conditions are not used, color-kinematics duality admits any kinetic term but the choice of propagator might spoil locality in the double-coppied theory.


Later in this section we will show that the interaction vertex is precisely that belonging to self-dual Yang-Mills (SDYM) theory in light-cone gauge. However, as we'll see, the kinetic term for these two theories differ -- the SDYM kinetic term transmutes between the holomorphic field $\Phi$, and the anti-holomorphic field, $\bar{\Phi}$, while the ZM scalar leaves the kinematic sector untouched. this is a critical distinction between the two theories that has important consequences for their color-dual constructions at loop-level.

While the color-dual nature of ZM theory is rather elegant, the loop-level construction introduces complications when applying dimensional regularization. Similar to the difficulties of renormalizing chiral fermions \cite{ 'tHooft}, there is ambiguity in promoting the integrands to formal $D$-dimensional expressions. As such, in our two-loop bootstrap of NLSM we will only use the ZM integrands as a mechanism for reducing the residual gauge freedom in our final solution -- rather than a full $D$-dimensional integrand to which we match off-shell in dim reg. 

Now we are prepared to discuss the one-loop case. 

\paragraph{Generalities of known color-dual theories -- James (I'll come back to this later)}
\begin{itemize}
\item There's also CS but the amplitudes are all zero (and marginally 10D N=1 SYM)
\item All of the theories described above have diff as kinematic algebra
\item All of the theories choose a simple gauge like Lorenz or lightcone
\item All of the theories place some constraint on the field strength directly and get their equations of motion directly from that constraint, not the YM EOM.
\item (Almost all of the theories (aside from NLSM) have trivial amplitudes at least at tree level)
\item This means that almost all of the theories only have CK at the classical level, which can sometimes be fudged into 1-loop as we'll now discuss.
\end{itemize}

\subsection{Color-dual Bootstrap}
Some background here on how we approach color-dual bootstrap (as we will utilize in our two-loop construction). Building an ansatz from irreducible lorentz products (ISPs). Comments about:
\begin{itemize}
\item loop momenta weight counting 
\item polynomial vector spaces 
\item generalized gauge freedom
\item functional jacobi constraints and cuts
\end{itemize} 
I suggest we put this all here in the intro/review so that people who know can skip, and then people who don't can read it and then be prepared to understand our approach before getting to the two-loop section.
\section{Isolating the cubic sector}
Here we'll describe the why constructing the full Yang-Mills kinematic algebra (outside self-dual sector) is generically hard, and why the same reason makes NLSM beyond one-loop hard as well. It has to do with out the vector state sum mixes with the four-point contact. In terms of our previously defined Feynman rules, the three-point YM vertex takes the form:
\be
\cubic{hgrey0}{gluon}{}{gluon}{}{gluon}{}  =  \cubic{hgrey0}{fermion2}{}{}{nhpRed}{}{nhpRed} + \cubic{hgrey0}{}{nhpRed}{fermion2}{}{}{nhpRed} + \Acubic{hgrey0}{}{nhpRed}{}{nhpRed}{fermion2}{} +\text{h.c.}
\ee
The state-sum between two three-point gluon vertex yields the following expansion in terms of YZ-theory vertices:
\be
 \AcubicB{hgrey0}{gluon}{}{gluon}{}{gluon}{}{gluon}{} =  \AcubicB{hgrey0}{}{nhpRed}{}{nhpRed}{fermion2}{}{fermion2}{} + 5 \text{ perms} + \AcubicB{hgrey0}{}{nhpRed}{}{nhpRed}{fermion2}{}{}{nhpRed}
\ee
All the $(\epsilon\epsilon)^1$ diagram permutations are isolated to the cubic sector and together manifest color-kinematics duality. However, the exception of the last diagram which introduces a $(\epsilon\epsilon)^2$ factor, must conspire with the Yang-Mills contact to preserve the duality off-shell

\be
\AcubicB{hgrey0}{}{nhpRed}{}{nhpRed}{fermion2}{}{}{nhpRed} = (s_{13}-s_{12}) \epsilon_{(12)} \epsilon_{(34)}
\ee
One was to resolve this is to introduce higher spin modes in order to accomodate the internal index contractions needed to recover the s-channal contract:
\be
\AcubicB{hgrey0}{}{nhpRed}{}{nhpRed}{Bfield}{nhpRed}{}{nhpRed} = s_{12 }(\epsilon_{(13)} \epsilon_{(24)} - \epsilon_{(14)} \epsilon_{(23)})
\ee
While introducing succesively higher spiin states to the NMHV lagrangian constructed in \cite{} could in principle work at tree level, we will see that it is not consiisntent with what we find at general loop order. We will comment on this in \sect{}. For now, we will study how to construct one-loop integrands consistent with the color-kinematics by isolating the cubic sector of the state sum above. This is easily understood in terms of a polarization decomposition introduced by one of the authors \cite{} that decomposes vector amplitudes in terms of building blocks that preserve partial amplitude relations. 
\subsection{Block Decomposition of Yang-Mills}
Describe how different orders in $\varepsilon_i\varepsilon_j$ in pure Yang-Mills captures different cubic and contact sectors of the theory. All the $D$-dimensional Lagnrangians above can be understood as selecting specific on shell states to isolate the cubic sector of Yang-Mills at a given loop order. Start with reducible amplitude block decomp from Ref. \cite:
\begin{eBox}
\begin{equation}\label{eq:pureVecRABD}
A_{(\sigma)}^{\text{YM}} = \sum_{k=0}^{\lfloor |\sigma|/2\rfloor}\sum_{\rho \in S^{2|k}_{\sigma}}\epsilon_{(\rho)} \Delta_{(\sigma)}^{(\rho)}\,.
\end{equation}
\end{eBox}
By a simple mass-dimensioin argument, we know the tree-level cubic sector is simply:
\be
A_{(\text{tree})}^{\text{cubic}} = \sum_{\rho \in S^{2|1}_{\sigma}}\epsilon_{(\rho)} \Delta_{(\sigma)}^{(\rho)}\,.
\ee
and likewise at one-loop:
\be
A_{(\text{1-loop})}^{\text{cubic}} = \sum_{\rho \in S^{2|0}_{\sigma}}\epsilon_{(\rho)} \Delta_{(\sigma)}^{(\rho)}\,.
\ee
We can select out both of these manifestly cubic sectors by selecting only $\epsilon^+\epsilon^+$ in light-cone gauge (i.e. SDYM) and one-minus at tree-level OR what $J$-theory and $YZ$-theory select with their on-shell states. Indeed, the $D$-dimensional description of $J$ theory is just the following blocks in the RABD expansion of Yang-Mills:
\be
A(...,\bar{J}_k,...)_{\text{tree}} = \sum_{j\neq k}\Delta^{(jk)}_{\text{tree}}
\ee
and similarly so at one-loop:
\be
A(...)_{\text{1-loop}} \equiv \Delta^{(\varnothing)}_{\text{1-loop}}
\ee
To recover NLSM at one-loop, we need to extract out the $D$-dependent part that corresponds to an internal $YY$-loop from extra-dimensional scalars:
\begin{eBox}
\be
A^{\text{NLSM}}_{\text{1-loop}} \equiv \partial_D \Delta^{(\varnothing)}_{\text{1-loop}}\big|_{\epsilon\rightarrow k}
\ee
\end{eBox}
Why must we take the derivative with respect to $D$? After all, $J$-theory and $YZ$-theory both have well defined propagators for internal $\bar{J}J$ and $\bar{Z}Z$ propagators. However, as we noted in the previous section, all the $J$ and $Z$ states must be on-shell in order to produce NLSM amplitudes. Thus, the unitarity cuts of $J$ theory at one-loop will not produce NLSM amplitudes. However, the internal $YY$-loop is a valid forward limit, since as constructed YZ theory is valid for off-shell Y-particles, and thus they serve as a valid forward limit. We will construct these one-loop integrands below in the next section. 
\subsection{One-loop SDYM Integrands}
\be
\simplebox = g_{\text{YM}}^4 X(k_1,l_1)X(k_2,l_2)X(k_3,l_3)X(k_4,l_4)
\ee
\subsection{One-loop NLSM Integrands}

Note from James:  I've explicitly checked the nice form of the 1-loop numerators at 4pt, 6pt, and 8pt.
\be
\simplebox = (2 f_\pi^{-1})^4 (l_1 k_1)(l_2 k_2)(l_3 k_3)(l_4 k_4)
\ee
where we define sequential loop momenta on the $n$-gon as $l_{i+1}= l_i+k_i$. Given this, the $n$-gon permits a equivalent expression in terms of inverse propagators:
\be
\simplebox =f_\pi^{-4} [12][23][34][41]
\ee
Where we have define the antisymmetric kinematic variable, $[LR] = l_i^L - l_R^2$
\subsection{Two-loop Obstruction}

\section{Bootstrapping two-loop...}

\subsection{Notes to self}
\begin{itemize}
\item Mention NANS after j theory.  Color kinematics duality doesn't care about the propagator but using a funny one might mess up locality in the double copied theory.
\item We should comment on 1-loop YM.  Can you easily write down the $n$-gon numerator?  I have some memory that someone has some complicated YM numerator.
\item Are you sure that the SDYM EOM doesn't come from just $F=\epsilon F$?  If $A=\partial \Phi$ then $F$ has the right number of derivatives to give the SDYM EOM but $DF$ has too many.
\item Write Lagrangian for j-theory and reiterate the argument about why you know it's pions.  Reiterate connection to ZM (dualize j and integrate in phi).  Should probably mention CS somewhere.  Point out that all of the theories that come from have CK are really some version of YM where you (1) impose some condition like F=0 or some other condition on the field strength and (2) you impose Lorenz gauge.  Point out that the kinematic algebra is always diffs.
\item Cite papers arguing about whether NLSM in 2D is non-trivial or not.
\item Explain why you need to take a certain portion of the YZ numerator to get the right answer.  Basically you can't have a vector particle circle the loop -- NLSM is a scalar theory so only scalar DOF should actually live in cuts.  If you have a tree then you plug in longitudinal modes but if you have a loop then you really need to remove vector modes so that only scalars circle the loop.
\item Reiterate that the (tree) amplitudes of CS and SDYM are zero.
\item ZM and 2D NLSM (PCM) are the same classically but not quantum mechanically.
This observation is due to other people but an easy way to see it.
ZM and 2D NLSM have the same EOM after a field redefinition.
This means that the classical physics is the same but of course the Lagrangians aren't the same and the field redefinition can change the path integral measure.
\item Forcing pions to match ZM in 2D does funny things.
The pion coupling constant is dropped but is implicitly set by the ordered 4pt amplitude which is normalized to be $-k_1 \cdot k_3$ in the package.
I've tabulated what happens when you take a general D NLSM answer and force it to match ZM in 2D.
Let's say that $n_\text{NLSM} = z n_\text{ZM}$ in 2D where I'm matching basis/master numerators.
For 4pt tree, $z=2/3$ (I matched the half ladder).
For 4pt 1-loop, $z$ is free/pure generalized gauge (I matched the box).
For 4pt 2-loop (when you impose certain $\ell$ power counting) $z$ is $216/565=\tfrac{2^3 3^3}{5 \cdot 113}$ (I matched the double box and penta-triangle).
For 6pt tree, $z$ is 12/35 (I matched the half ladder).
So you can match kinematic structure (the combination of Mandelstams) of NLSM to ZM in 2D but you can't get the coupling constant right at loop level, that is, ZM is a different theory quantum mechanically.
Actually these numbers make it look like you can't even match the theories classically but I guess for the theories to match classically you only need the amplitudes to agree and I matched numerators.
\item Explain how matching to ZM is a little silly.
Check that NLSM and ZM numerator agree on cuts.
Can't do that or else it becomes subtle.
Only well defined object is numerator.
\item At 4pt 1-loop $\prod p_L^2 -p_R^2$ agrees with the ZM answer $\prod p_L \eps p_R$ up to some number.
At 6pt 1-loop this is not true and the two answers differ by alternating signs depending on the kinematic configuration.
\item You cannot lift ZM to general D NLSM in the democratic way that Nic described because it fails at 6pt tree.  So you take the ZM answer that looks like $\langle 1 2\rangle \langle 3 4\rangle...$ you can convert every pair of angles to dot products using 2D $\epsilon$ identities.  Make an ansatz where you do every pairing of $\epsilon$'s.  This doesn't work.
\item To clean up the NLSM 4pt 2-loop answer I forced the answer to match ZM in 2D.
The ZM answer also only has certain powers of loop momenta $\ell^5$...$\ell^8$ where $\ell$ represents any combination of $\ell_1$ and $\ell_2$.
I enforce this $\ell^5$...$\ell^8$ behavior on the NLSM ansatz too.
\item Describe Jacobi:  s,t,u channel color factors sum to zero so you want numerators to do the same
\item Remember that I've explicitly checked the nice form of the 1-loop NLSM numerators at 4pt, 6pt, and 8pt.
\item Should probably give the 4pt pion amplitude somewhere to show my conventions.
\end{itemize}

\subsection{Pions -- James}

As we have seen, it is possible to coerce tree numerators into 1-loop numerators at any multiplicity for pions.
However, these methods cannot be reapplied to generate 2-loop numerators, which begs the question ``is it possible to find globally color-dual numerators beyond 1-loop''.
By ``global'' we mean that color-kinematics duality is satisfied in any kinematic configuration of the integrand.
This is a much more stringent condition than absolutely necessary.
There is reason to believe (cite Zvi et al) that global numerators cannot always be found.
One resolution to the issue is to only demand color-kinematics duality on the unitarity cuts of the integrand, i.e., in specific kinematic limits.
Enforcing Jacobi on the cuts is enough to ensure that the squared integrand will correctly cut to gravity (or whatever the squared theory might be).
When a globally color-dual numerator cannot be found, another alternative explored in the literature is to increase the size of the numerator ansatz by enlarging the numerator from a polynomial to a rational function with spurious singularities (cite Donal et al).
When global color-kinematics fails, the hope is that it can be restored by enlarging the size of the ansatz, either by giving the numerator of each graph its own ansatz (first option described) or by promoting the numerator to a non-local function (second option described).
Note that a theory whose Lagrangian has color-kinematics duality would naturally produce a globally color-dual integrand so the quest for a global numerator is closely related to the existence of a Lagrangian exhibiting color-kinematics duality.
We will begin by tackling the issue of a global 4pt 2-loop numerator for NLSM before moving on to YM.
Two-loop color-dual integrands for pure YM have been investigated before but only for a limited ansatz that manifests locality (cite Zvi et al paper).

Aside from a few special theories (cite blah), color-dual integrands are constructed from an ansatz.
Color-kinematics duality is stated in terms of cubic graphs so the first step is to express in the integrand in terms of such graphs.
Naively there are 14 cubic 4pt 2-loop topologies ignoring tadpoles and bubble on external leg (BEL) graphs.
It is always possible to express an integrand in terms of cubic graphs, even for an even valency theory like NLSM, by multiplying and dividing the integrand by factors of inverse propagators.
Next, the ansatz must have the correct power counting and external states.
Since pions are scalars the numerators will not carry any spinors or polarization vectors.
Every vertex in NLSM scales as $k^2$ so, for example, the numerator of a cubic 4pt 2-loop diagram scales as $k^{12}$ so there are 8,008 independent dot products of momenta at this mass dimension.
The numerator is assumed to be manifestly local but one approach to finding color-dual numerators is to relax manifest locality, see (...) for more details.
After zeroth order considerations like power counting, there are three conditions that are imposed on the ansatz: (1) Jacobi relations amongst graphs must be satisfied, (2) numerators must respect graph symmetries, and (3) the integrand must have the correct unitarity cuts.

\subsubsection{Jacobi relations}

Jacobi relations are the heart of color-kinematics duality.
The color factors in an integrand obey a set of Jacobi identities.
Color-kinematics duality states that there exists a way of writing the kinematic numerators of the integrand so that they obey the same set of Jacobi identities.
(Can trivially read off the adjoint color factors from a cubic graph.)
So if any triplet of graphs is related by a Jacobi identity, so too must their numerators.
Broadly speaking there are two kinds of Jacobi identities.
The first kind relate graphs to a basis.
For example, the double box, crossed box, and penta-triangle are related to each other as follows
\be % [[11]]
\label{eq:TwoLoopJacobiOne}
\JacobiOneDoubleBox +  \JacobiOneCrossedBox + \JacobiOnePentaTriangle =0.
\ee
where the shared propagator is shown in red.
Using this relation the crossed box can be written in terms of the other two.
In this way, all of the 14 cubic 4pt 2-loop topologies can be written in terms of a basis of the double box and penta-triangle.
(Any two of the double box, crossed box, and penta-triangle would have sufficed for a basis but the planar basis was chosen for simplicity.)
Each of the two basis graphs receives its own numerator ansatz and the numerator of any other graph can be expressed in terms of these.
As mentioned before, there are 8,008 linearly independent dot products of momenta of the required mass dimension so the total number of free parameters in the system is 16,016.
As this is too many parameters for \texttt{Mathematica} to reasonably handle, we employ a custom solver suitable for the moderately dense systems appearing in this context.
(Scalars might generate denser systems since ever dot product can interfere with every other unlike gauge theories which separate based on polarization structure, can cite Nic. \nhp{ distinguish between NLSM and YM ansatz -- i.e. why is 10,010 per diagram solvable for YM, but 8,008 per diagram runs into issues for NLSM. As you said, emphasize the density of NLSM matrix inversion due to generalized gauge freedom vs. independent polarization structures for YM.})

The second kind of Jacobi relations relate basis elements to themselves.
For example, the crossed box numerator is related to itself via the following Jacobi relation
\be % [[19]]
\label{eq:TwoLoopJacobiTwo}
\JacobiTwoCrossedBoxOne + \JacobiTwoCrossedBoxTwo +  \JacobiTwoCrossedBoxThree =0,
\ee
where the shared propagator is shown in red as before.
Each of the crossed box numerators can be represented in terms of the double box and penta-triangle so this Jacobi relation places constraints on the basis numerator ansatze.
The first kind of Jacobi relations simplifies how many numerators require ansatze whereas the second kind of Jacobi relations place constraints on the remaining numerators.
In principle there could be Jacobi relations involving tadpoles and BEL graphs, which would be subtle to handle.
One option is to force the numerators of these graphs to zero.
However, since these graphs will not contribute to physical unitarity cuts, we take a different approach.
These graphs are allowed to have non-zero numerators but any Jacobi relations involving them are simply not imposed or solved.
See (4 loop N=4 paper) for a discussion of BELs in the context of color-kinematics duality.

In total, there are 21 Jacobi relations on the 14 cubic 4pt 2-loop graphs where, again, tadpole and BEL graphs are ignored.
How many constraints fixed.

\subsubsection{Graph symmetries}

The second key constraint in an ansatz construction of color-dual numerators comes from graph symmetries.
Every numerator is required to respect all of the symmetries (or automorphisms) of its associated graph.
While it is very convenient to impose graph symmetries, it is not completely necessary in order to perform the double copy.
At tree level, finding manifestly color dual numerators is often achieved at the expense of manifest Bose symmetry (see YZ theory, j-theory, Alex numerators from CHY, Henrik numerators).
Nonetheless, for a pure ansatz construction it is very reasonable to impose graph symmetries.
Note that the graph symmetry constraint is imposed on \emph{every} graph, not just the basis graphs.
For example, the crossed box, \be
\CrossedBoxGraphSym
\ee
is unchanged upon reflection across the horizontal axis (shown as a blue dashed line).
Since the crossed box can be written in terms of the double box and penta-triangle, this imposes non-trivial constraints on the ansatz.

Imposing graph symmetries on the ansatz further reduces the DOF to ...

\subsubsection{Unitarity}

The last key constraint is that the ansatz have the correct unitarity cuts, that is, that the integrand corresponds to the correct theory.
Generalized unitarity has been reviewed in many places (cite...) so we will not belabor the details here, in particular see (emu) for a recent treatment of unitarity methods for even multiplicity theories like NLSM.
The essence of generalized unitarity is that when internal lines are placed on-shell, the integrand should factorize into a product of on-shell tree amplitudes.
The cut to be performed can, itself, be encoded in a graph.
For example, potential 4pt 2-loop cuts include
\be
\label{eq:PotentialCuts}
\text{(a)} \SubtleCut ~~~~ \text{(b)} \PhysicalCutOne{}{}{}{} ~~~~ \text{(c)} \PhysicalCutTwo{}{}{}{} ~~~~ \text{(d)}  \MaxCut
\ee
as well as many more.
In these graphs, all exposed propagators are understood to be cut/on-shell.
As an equation, a unitarity cut this looks schematically like
\be
\label{eq:SchematicCutEquation}
\sum \limits_\text{topologies} \frac{n \vert_\text{cut}}{\prod \limits_\text{uncut} k^2} = \sum \limits_\text{states} \prod \limits_\text{blobs} A_\text{tree} .
\ee
The right hand side of the equation is a product of on-shell tree amplitudes, represented graphically in \eqref{eq:PotentialCuts} by grey blobs.
States crossing (or propagating across) the cut must be summed over.
For scalars this sum is trivial but for spinning particles this is no longer the case and the physical state projector must be inserted (see Dimitrius paper for simplifying this operation).
The graph topologies appearing in the left hand side of \eqref{eq:SchematicCutEquation} come from blowing up the grey blobs into cubic tree graphs in every conceivable way.
For each of these topologies, the numerator of the associated graph is subjected to the cut constraints and is then divided by the uncut propagators.
The right hand side is assumed to be known, which places a constraint on the numerator ansatze in the left hand side.

It is possible to work with either color-dressed cuts or color-ordered cuts.
For color-dressed cuts the grey blobs are blown up into all possible channels and all color factors $f^{abc}$ are explicitly retained (both in the integrand numerators and in the tree amplitudes).
For color-ordered cuts the grey blobs are only blown up in color ordered channels, the color factors can be suppressed, and the product of on-shell amplitudes only extends over color-ordered trees.
We elect to use color-ordered cuts.
Since these cuts do not contain the full color information of the theory, it is necessary to do multiple color-ordered cuts -- over different orderings of the blob labels -- in order to fully capture all of the cut information.
For a color dual theory such as NLSM it is enough to do $(n-2)!$ labelings of each blob due to the Kleiss-Kuijf and $U(1)$ decoupling identities (cite KK).
In this sense color-dressed cuts contain extraneous information that is bypassed when using color-ordered cuts.

In our construction, only well-defined cuts are imposed so, for example, cut (a) of \eqref{eq:PotentialCuts} is not enforced since it is possible to blow up the left blob into a tree amplitude with an on-shell internal propagator.
Cuts (b) and (c) are the only non-vanishing 4pt 2-loop physical cuts for an even multiplicity theory.
This means that even at two loops, unitarity cuts are still only probing the on-shell 4pt NLSM amplitude.
Even though (b) and (c) are the only non-zero cuts, other cuts, for example the maximal cut (d), must also be imposed in order to correctly reproduce NLSM.
The maximal cut vanishes because only 3pt amplitudes contribute and these amplitudes vanish in any scalar theory.
It is possible to automatically enforce (or ``bake in'') the double box and penta-triangle max cuts on the ansatz by writing the ansatz in terms of inverse propagators (and remaining irreducible scalar products) and then only keeping terms that involve at least one inverse propagator since those terms will vanish on those max cuts, just as the product of 3pt scalar amplitudes will.
However, for the sake of simplicity we do not take this route.

How many DOF left after imposing cuts

References for Jacobi, unitarity, etc.

Why aren't the two physical cuts spanning?  I know from experience that they're not but I can't easily explain why.

\subsubsection{Matching to ZM -- James}

After imposing all of the three key constraints (Jacobi, graph symmetries, and unitarity), there still remains a plethora of generalized gauge freedom in the X unconstrained ansatz parameters.
At this point color kinematics duality has been satisfied so the double copy will proceed without issue, but it is possible to enforce additional, more aesthetic, constraints as desired.
$\mathcal{N}=4$ SYM provides several hints for further conditions to impose on the ansatz.
For example, for maximally supersymmetric gauge theory it is possible to enforce the no triangle hypothesis, manifest loop power counting, and, at least for 4pt and up to four loops, strip off a factor of $st A_\text{tree}$ from the integrand (I'm not sure I know all of the papers to cite here).
For the NLSM integrand it is desirable to make color-kinematics duality as manifest as possible.
One hope would be to factor out some piece of the 1-loop numerator since this at least manifests antisymmetry on some of the legs.
However, a more fruitful direction is to match onto the one known theory with pion power counting that manifests color-kinematics duality to all loop order, namely, ZM theory.


ZM plagued by (suffers from) IR regulation issues.
Only one of the two physical/meaningful cuts can be done in a non-subtle way.
We're using ZM more as a tool to... -- We know ZM has the right kinematic structure to give CK in 2D so we're just matching onto that because we can.  ZM and NLSM can be different at quantum level.

Can't match to ZM on all of the physical cuts (one of them is always subtle).  Matching to ZM should be interpreted as just a way to simplify things, not really physical.

Cut (b) is always subtle

Match the $\ell$ structure of ZM

This is the object we include in the ancillary files, maybe with the remaining variables set to zero

For 4pt on-shell ZM, the LRLR configuration is zero and for every other configuration of external states the on-shell amplitude is subtle because of IR poles.  Note that the (on-shell) kinematic numerators are always unambiguous and never suffer from any of these subtleties in any kinematic configuration.  So when you compare against ZM, you either comparing against zero or something subtle.  This is why you can't really take cuts of the NLSM and ZM integrands and meaningfully compare them even though you can compare their numerators.

\subsection{Double-copy -- Alex }

\begin{itemize}
\item  ``Most important'' check of Jacobi -- imposes ``diff'' invariance in the DC numerators
\item Match against cuts from \cite{Carrasco:2023qgz}: double copy
  with N=0 \cite{Bern:2015ooa}, N=4, itself
  \item Whip up a non-jacobi N=0 or $\pi$ to highlight double copy success?
\end{itemize}

\subsection{Yang-Mills revisited -- Alex}
Transition paragraph.....

As part of attemtping to construct a color-kinematics dual
representation for $\mathcal{N}=0$ Yang--Mills at two loops, Bern,
Davies, and Nohle (BDN) lay out the following core assumptions for
integrand numerators (in addition to obeying some form of the
kinematic Jacobi relations) \cite{Bern:2015ooa}
\begin{enumerate}
\item Locality: Diagram ``numerators'' are polynomials in momenta and
  polarizations, \eg the diagrams only have poles given by the
  propagators of the diagrams. \emph{We explore a minor breaking of this assumption}
\item Power-counting: The maximum power of the loop momenta in the
  numerator is boudned by Feynman-gauge Feynman rules.  \emph{We
    explore breaking this assumption}.
\item Cubic diagrams: The only diagrams with nonzero numerators are
  those with strictly cubic vertices.  This is generally a requirement
  to properly define the kinematic Jacobi relations.
\item Relabeling : The diagram numerators are only a function of the
  diagram's topology and labeling
\item Symmetries: The diagram numerators are invariant under the
  automorphisms of the diagrams \emph{including signs that compensate
    for color-factor sign changes}
\item Unitarity cuts: The cuts of the ansatz must reproduce the
  physical unitarity cuts of the theory.
\end{enumerate}
They demonstrated that the above assumptions are incompatible with an
off-shell solution to the kinematic Jacobi relations.  Here, we
explore two violations of these core assumptions.

First, we analyze the power-counting assumption.  In our labeling of
the two loop Jacobi-basis diagrams, shown in \ace{Figure out fig}, we
find that the power counting bound proposed by Bern, Davies, and Nohle
leads to an initial ansatz with XX terms in the double-box, and YY
terms for the penta-triangle.  However, recent work by Ben-Shahar,
Garozzo, and Johansson \cite{Ben-Shahar:2022ixa} \ace{Are there other
  good examples?} demonstrates that constructing Feynman rules that
produce manifestly color-dual numerators for the NMHV sector of
Yang--Mills requires introducing additional auxiliary fields,
including higher-spin modes, which could shift the expected power
counting in non-trivial ways.  We therefore attempt to find an
off-shell color-dual Yang--Mills representation in which all power
counting restrictions are lifted.

Without power counting restrictions, both the double-box and the
penta-triangle ansatz have an initial ansatz with 10,010 terms each.
Imposing diagram automorphisms on the two basis diagrams, we reduce
the number of terms to XX.  Gauge invariance on support of the maximal
cuts of the basis diagrams further reduces the remaining freedom to
YY.  The power-counting restriction of BDN would reduce this count to
ZZ.  In the original BDN work, they imposed three spanning generalized
unitarity cuts, shown in [].  Instead of directly imposing the
spanning cuts, we proceed with the relaxed version of the method of
maximal cuts used above in the pion construction [\ace{is James going
  to talk about something along this line in the pions section?}].  We
find that even with the completely generic ansatz, the representation
fails to satisfy the next-to-next-to-maximal cut shown in [].
Notably, imposing the BDN power-counting constraints additionally
causes a discrepancy with the N$^2$-max cuts show in [].



\begin{itemize}
\item Recap assumptions of \cite{Bern:2015ooa}
\item Going beyond ``Feynman-type counting'' $\to$ 10010 initial
  ansatz.  Compare post-(sym+GI) on BCJ basis.
\item Discuss which cuts still fail.  Double check these statements
  \item Attempt at non-local.  Still have problems with cuts+syms+jacobi
  \end{itemize}

\section{... and Beyond}
This could be a section about our expectations for all-loop construction requiring non-local color-dual integrands. Lay out contrafactual proof, i,e. define the following statement:
\be
 Q_L=\textit{``the $L$-loop numerator is polynomial and color-dual"}. 
\ee
Then it is clear that if the kinematic numerator is polynomial and color-dual, evaluating it in kinematic regions where the internal legs are on-shell won't disrupt the kinematic algrebraic relations, and it must still be polynomial. Thus we find:
\be
Q_L \Rightarrow Q_{L-1}
\ee
Or equivalently,
\be
\text{not }Q_{L-1}\Rightarrow \text{not }Q_L
\ee
We have found that the two-loop integrand for Yang-Mills cannot be constructed from a color-dual polynomial kinematic numerator. Thus, if a color-dual representation exists at all-loop order for Yang-Mills it must be a rational function of kinematics. 
  
\section{Discussion}\label{sec:Discussion}
\paragraph{Acknowledgments} The authors would like to thank ... for insightful conversations, related collaboration, and encouragement throughout the completion of this work. This work was supported by the DOE under contract DE-SC0015910 and by the Alfred P. Sloan Foundation. N.H.P. additionally acknowledges the Northwestern University Amplitudes and Insight group, the Department of Physics and Astronomy, and Weinberg College for their generous support. 

Figures made with TikZ-Feynman [1601.05437]

\appendix
\section{Spinor-Helicity and Conventions}
Dimensions will generically be away from four, in $D=4-2\epsilon$, with $\epsilon$ arbitrary. As noted, it will be convenient to take $D\rightarrow 4$ in certain circumstances after integration.  In such cases we will employ appropriate spinor-helicity variables.  Here we apply the same conventions of Ref.~\cite{jjmcTASI2014}, which we quote now. For massless momenta, $k_a$ and $k_b$, we have 
\begin{equation}
s_{ab} = (k_a+k_b)^2= \langle ab \rangle[ba]\,,
\end{equation}
the component definition of our spinor bracket that are consistent with the conventions above,
\begin{align}
\langle ab \rangle &= \frac{(a_1 + i a_2)(b_0+b_3)-(b_1 + i b_2)(a_0+a_3)}{\sqrt{(a_0+a_3)(b_0+b_3)}}\,,
\\
[ab] &= \frac{(b_1 - i b_2)(a_0+a_3)-(a_1 - i a_2)(b_0+b_3)}{\sqrt{(a_0+a_3)(b_0+b_3)}}\,,
\end{align}
where the $a_i$ are component values of the four-vector, $k^\mu_a = (a_0,a_1,a_2,a_3)$. Four-dimensional polarization dot products with fixed helicity states can be mapped as follows:
\begin{equation}\label{eqn:4DPols}
\begin{aligned}
k_a \cdot \varepsilon_b^{(+)} &= \frac{\langle q a \rangle[ab]}{\sqrt{2}\langle q b\rangle}\,,
\qquad\quad \qquad
k_a \cdot \varepsilon_b^{(-)} = -\frac{[qa]\langle ab\rangle}{\sqrt{2}[qb]}\,,
\\
\varepsilon_a^{(-)}\cdot \varepsilon_b^{(+)} &= - \frac{\langle q a\rangle [qb]}{ [qa]\langle q b\rangle} \,,
\qquad \qquad
\varepsilon_a^{(\pm)}\cdot \varepsilon_b^{(\pm)} = 0 \,,
\end{aligned}
\end{equation}
Note that given the above definition, the spinor helicity variables carry the same mass dimension for both the angle and square brackets. In terms of light-cone coordinates that we employed in the text, the angles and squares can be rewritten as follows:
\begin{align}
\langle ab \rangle &= \frac{a_w b_u-a_u b_w}{\sqrt{a_ub_u}}\,,
\\
[ab] &= \frac{b_{\bar{w}}a_u-a_{\bar{w}}b_u}{\sqrt{a_ub_u}}\,,
\end{align}
The conventions we use in the text where the holomorphic spinor cares extra mass dimension essentially amounts to shifting the bracket by the following:
\begin{align}
\langle ab \rangle &\rightarrow a_w b_u-a_u b_w \equiv X(a,b)\,,
\\
[ab] &\rightarrow \frac{b_{\bar{w}}a_u-a_{\bar{w}}b_u}{a_ub_u}\equiv Q(a,b)\,,
\end{align}
With this, we still obtain the same completeness relation for the SDYM spinors:
\be
X(a,b)Q(b,a) = \frac{1}{2}s_{ab}
\ee
\section{Regulating BEL integrals}
At one-loop, weight counting tells us that the $n$-gon master numerator must have $n$ on-shell $Z$-particles. Unitarity requires that there are three distinct contributions from $Y\!Z$ theory -- the first from an off-shell $Y$-loop particle and then two more from different orientations of a $\bar{Z}Z$-loop.  Thus, $Y\!Z$ theory gives us the following one-loop $n$-gon numerator:
\be
N^{n\text{-gon},YZ}_{(12...n)} = (T^{1}T^{2}\cdots T^{n})+2\, (F^1F^2\cdots F^n)
\ee
where $(\,\cdots)$ indicates an internal contraction over the $YY$ and $\bar{Z}Z$ loops. Plugging in the Feynman rule of \eqn{eq:FeynmanRuleYYZ} and \eqn{eq:FeynmanRuleXZZ}, we can readily obtain expressions in terms of the internal loop factors $l_i$ and the external momenta $k_i$ (we define the $l_i$ loop momentum as that flowing into $k_i$ and out of $k_{i-1}$):
\be
N_{(12...n)}^{\text{NLSM}}=(T^{1}T^{2}\cdots T^{n}) = (l_1 k_1)(l_2 k_2) \cdots (l_n k_n)
\ee
and similarly so for the internal vector contribution:
\be
 (F^1F^2\cdots F^n) = (D-4)(l_1 k_1)(l_2 k_2) \cdots (l_n k_n) + \mathcal{O}(D^0)
\ee
The dimension dependent factor essentially counts that number of internal vector states. While this $n$-gon is manifestly color-dual, it does not produce the right cuts for NLSM. However, the scalar contribution, that comes dressed with an overall factor $(D-4)$ \textit{does} manifest the duality globally, and satisfies all the desired pion cuts. In order for the Feynman rules for $Y\!Z$ theory compute one-loop color-dual numerators consistent with NLSM cuts, we must add some additional states to cancel off he spurious poles, while preserving color-kinematics duality. We leave this as a direction of future work. 

While the $\bar{Z}Z$ vector loop spoils color-kinematics off-shell, the $Y\!Z$ loop alone gives us a desired expression for the $n$-gon. The important takeaway is that we now have a guess for the form of the off-shell three-point vertex that has a chance of manifesting the duality off-shell. The $n$-gon numerator above has scalar insertions of the following kinematic vertex:
\be
T^{a}_{LR} = k_a(l_L-l_{R}) = (l_L+l_{R}) (l_L-l_{R})  = l_L^2-l_{R}^2 
\ee
Given this structure, in the next section we will attempt to construct two-loop basis diagrams from these cubic vertex assignments and try to reverse engineer the particle content that produces these master numerators.

Before proceeding, we note a strange property of the $n$-gon numerator for the pions. In this form, Jacobi relations produce \textit{non-vanishing} values for bubbles on external legs (BELs). However, it is easy to see that the contribution integrates to zero after applying IBP relations/tensor reduction on the bubble. The BEL diagram can be reconstructed from the $n$-gon as follows:
\be
N^{\text{BEL}}_{1|2,34} = N^{\text{NLSM}}_{(1234,l)}-N^{\text{NLSM}}_{(1243,l)}-N^{\text{NLSM}}_{(1342,l)}+N^{\text{NLSM}}_{(1432,l)}
\ee
where we define the loop momentum to be in between the left most and right most leg on the box. Plugging in particular values for $l_i$, we obtain the following expression for the BEL
\be
N^{\text{BEL}}_{1|2,34} = s_{12} (l+k_1)^2 l^{\mu} k_1^{\nu} k_2^{[\mu} k_{[34]}^{\nu]} 
\ee
Notice there is an overall factor that cancels one of the propagators. Plugging this in, produces an integral of the following form
\be
\mathcal{I}^{\text{BEL}}_{1|2,34} = s_{12} k_1^{\nu} k_2^{[\mu} k_{[34]}^{\nu]} \int \frac{d^D l}{i\pi^{D/2}} \frac{l^\mu }{l^2-\mu^2} \sim   s_{12}(s_{13}-s_{14}) (\mu^2)^{D/2}
\ee
where we have introduced a mass regulator that will be proportional the the on-shell momentum inside the BEL, $\mu^2 \equiv k_1^2$. Thus, in large enough dimension, this integral suppresses the $\mu^{-2}$ divergence appearing in the denominator of the BEL diagram. 
\bibliographystyle{JHEP}
\bibliography{Refs_2loopNLSM}
\end{document}


%%% Local Variables: 
%%% TeX-command-extra-options: "-shell-escape"
%%% End: